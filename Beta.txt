This code is written by Partheepan
New coded added by Sri.